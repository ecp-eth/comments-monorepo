# Comment Data

`Comment Data` is a data structure that contains the essential information of a comment.

## `content`

The comment content stores the plain text content of the comment.

- Please use `\n` for line breaks. (Most browsers will normalize the line breaks to `\n` regardless of the OS).

## `metadata`

The `metadata` property stores additional data that shouldn't be shown to the user as it is.

- Must be a valid JSON string (RFC 8259)[https://datatracker.ietf.org/doc/html/rfc8259].
- Please be mindful that storing large amounts of data on the chain will increase the cost of the transaction.

## `targetUri`

It serves as a unique identifier for locating comments.

Be careful when choosing the value for the `targetUri` property as an inconsistent `targetUri` will result in some comments missing from the indexer response.

- Any URIs, as long as it is a unique string that follows the [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) standard.
- If your web page is dynamic and accepts query parameters, you should carefully consider which parameters are necessary to locate the correct comments. As a general rule:

  1. Normalize the URL, e.g. using [`normalize-url`](https://www.npmjs.com/package/normalize-url).
  1. Sort the query parameters using `sortQueryParameters` from [`normalize-url`](https://www.npmjs.com/package/normalize-url).
  1. Do not include query parameters unrelated to page content, such as tracking or feature flags.

- If the comment is a reply to a comment then set the value to `undefined`.

### App/Chain Agnostic URIs

Whenver possible, it is recommended to use app or chain agnostic URIs, e.g. [CAIP-19](https://github.com/ChainAgnostic/namespaces/blob/main/eip155/caip19.md) specification for referencing onchain or offchain assets.
This ensures the reference is consistent and maximal compatibility across different applications and chains.

Example (NFT and collection):

```
chain://eip155:1/erc721:0xa723a8a69d9b8cf0bc93b92f9cb41532c1a27f8f/11
chain://eip155:1/erc721:0xa723a8a69d9b8cf0bc93b92f9cb41532c1a27f8f
```

## `parentId`

The `parentId` property is used to store the parent comment id.

- If the comment is a reply to a comment, set the `parentId` to the id of the parent comment.
- If the comment is a top-level comment, leave it `undefined`.

## `author`

The `author` property is used to store the author's address. It is the address of the account that created and owns the comment.

## `app`

The `app` property is used to store the app signer's address. The app signer represents the the owner of the app or community.
If you are creating features just for yourself to post, such as a blog, you can use your own address as the `app`.

To see detailed explanation please refer to the [Dual-signature System](./dual-signature-system.mdx) page.

## `nonce`

An integer value that prevents replay attacks, this value is automatically incremented with each action per user per app.

- It is used to prevent replay attacks.
- It is used as part of the hashing process to generate a unique comment id.

## `deadline`

The deadline is a timestamp in seconds since the epoch. Posting a comment with an expired deadline will result in the transaction being reverted.

- It must be a future timestamp.
- It provides a guarantee around the timestamp when the user or app countersigned the comment.
